The history of war teems with occasions where the interception of
dispatches and orders written in plain language has resulted in
defeat and disaster for the force whose intentions thus became known
at once to the enemy. For this reason, prudent generals have used
cipher and code messages from time immemorial. The necessity for
exact expression of ideas practically excludes the use of codes for
military work although it is possible that a special tactical code
might be useful for preparation of tactical orders.

It is necessary therefore to fall back on ciphers for general military
work if secrecy of communication is to be fairly well assured. It
may as well be stated here that no practicable military cipher is
mathematically indecipherable if intercepted; the most that can be
expected is to delay for a longer or shorter time the deciphering of
the message by the interceptor.

The capture of messengers is no longer the only means available to
the enemy for gaining information as to the plans of a commander. All
radio messages sent out can be copied at hostile stations within radio
range. If the enemy can get a fine wire within one hundred feet of a
buzzer line or within thirty feet of a telegraph line, the message can
be copied by induction. Messages passing over commercial telegraph
lines, and even over military lines, can be copied by spies in the
offices. On telegraph lines of a permanent nature it is possible to
install high speed automatic sending and receiving machines and thus
prevent surreptitious copying of messages, but nothing but a secure
cipher will serve with other means of communication.

It is not alone the body of the message which should be in cipher. It
is equally important that, during transmission, the preamble, place
from, date, address and signature be enciphered; but this should
be done by the sending operator and these parts must, of course,
be deciphered by the receiving operator before delivery. A special
operators' cipher should be used for this purpose but it is difficult
to prescribe one that would be simple enough for the average operator,
fast and yet reasonably safe. Some form of rotary cipher machine
would seem to be best suited for this special purpose.

It is unnecessary to point out that a cipher which can be deciphered
by the enemy in a few hours is worse than useless. It requires a
surprisingly long time to encipher and decipher a message, using even
the simplest kind of cipher, and errors in transmission of cipher
matter by wire or radio are unfortunately too common.

Kerckhoffs has stated that a military cipher should fulfill the
following requirements:


    1st. The system should be materially, if not mathematically,
         indecipherable.
    2d.  It should cause no inconvenience if the apparatus and methods
         fall into the hands of the enemy.
    3d.  The key should be such that it could be communicated and
         remembered without the necessity of written notes and should
         be changeable at the will of the correspondents.
    4th. The system should be applicable to telegraphic correspondence.
    5th. The apparatus should be easily carried and a single person
         should be able to operate it.
    6th. Finally, in view of the circumstances under which it must
         be used, the system should be an easy one to operate,
         demanding neither mental strain nor knowledge of a long series
         of rules.


A brief consideration of these six conditions must lead to the
conclusion that there is no perfect military cipher. The first
requirement is the one most often overlooked by those prescribing
the use of any given cipher and, even if not overlooked, the
indecipherability of any cipher likely to be used for military purposes
is usually vastly overestimated by those prescribing the use of it.

If this were not true, there would have been neither material for,
nor purpose in, the preparation of these notes. Of the hundreds of
actual cipher messages examined by the writer, at least nine-tenths
have been solved by the methods to be set forth. These messages were
prepared by the methods in use by the United States Army, the various
Mexican armies and their secret agents, and by other methods in common
use. The usual failure has been with very short messages. Foreign
works consulted lead to the belief that many European powers have
used, for military purposes, cipher methods which vary from an
extreme simplicity to a complexity which is more apparent than
real. What effect recent events have had on this matter remains to
be seen. It is enough that the cipher experts of practically every
European country have appealed to the military authorities of their
respective countries time and again to do away with these useless
ciphers and to adopt something which offers more security, even at
the expense of other considerations.

The cipher of the amateur, or of the non-expert who makes one up
for some special purpose, is almost sure to fall into one of the
classes whose solution is an easy matter. The human mind works along
the same lines, in spite of an attempt at originality on the part of
the individual, and this is particularly true of cipher work because
there are so few sources of information available. In other words,
the average man, when he sits down to evolve a cipher, has nothing
to improve upon; he invents and there is no one to tell him that his
invention is, in principle, hundreds of years old. The ciphers of the
Abbé Tritheme, 1499, are the basis of most of the modern substitution
ciphers.

In view of these facts, no message should be considered
indecipherable. Very short messages are often very difficult and may
easily be entirely beyond the possibility of analysis and solution,
but it is surprising what can be done, at times, with a message of
only a few words.

In the event of active operations, cipher experts will be in demand
at once. Like all other experts, the cipher expert is not born or
made in a day; and it is only constant work with ciphers, combined
with a thorough knowledge of their underlying principles, that will
make one worthy of the name.








CHAPTER I

EQUIPMENT FOR CIPHER WORK


Success in dealing with unknown ciphers is measured by these four
things in the order named; perseverance, careful methods of analysis,
intuition, luck. The ability at least to read the language of the
original text is very desirable but not essential.

Cipher work will have little permanent attraction for one who expects
results at once, without labor, for there is a vast amount of purely
routine labor in the preparation of frequency tables, the rearrangement
of ciphers for examination, and the trial and fitting of letter to
letter before the message begins to appear.

The methods of analysis given in these notes cover only the simpler
varieties of cipher and it is, of course, impossible to enumerate all
the varieties of these. It is believed that the methods laid down are
sound and several years of successful work along this line would seem
to confirm this belief. For more advanced work there is no recourse
but to study the European authorities whose writings are mostly in
French, German, and Italian and, unfortunately, are rarely available
in English translations.

Under intuition must be included a knowledge of the general situation
and, if possible, the special situation which led to the sending
of the cipher message. The knowledge or guess that a certain cipher
message contains a particular word, often leads to its solution.

As to luck, there is the old miner's proverb: "Gold is where you
find it."

The equipment for an office, where much cipher work is handled,
will now be considered. The casual worker with ciphers can get along
with much less, but the methods of filing and keeping a record of all
messages studied should be followed wherever possible. The interchange
of results between individuals and between offices should be encouraged
and, in time of active operations, should be mandatory. An enemy
may be using the same cipher in widely separated parts of the zone
of operations and it is useless labor to have many cipher offices
working on intercepted messages, all in the same cipher, when one
office may have the solution that will apply to all of them.

Cipher work requires concentration and quiet and often must proceed
without regard to hours. The office should be chosen with these points
in mind. A clerical force is desirable and even necessary if there
is much work to do. The clerk or clerks can soon be trained to do
the routine part of the analysis.

It is believed that each Field Army should have such an office
where all ciphers intercepted by forces under command of the Field
Army Commander should be sent at once for examination. This work
naturally falls to the Intelligence section of the General Staff at
this headquarters. A special radio station, with receiving instruments
only, should be an adjunct to this office and its function should
be to copy all hostile radio messages whether in cipher or plain
text. Such a radio station requires but a small antenna; one of the
pack set type or any amateur's antenna is sufficient, and the station
instruments can be easily carried in a suit case. Three thoroughly
competent operators should be provided, so that the station can be
"listening in" during the entire twenty-four hours.

The office should be provided with tables of frequency of the language
of the enemy, covering single letters and digraphs; a dictionary and
grammar of that language; copies of the War Department Code, Western
Union Code and any other available ones; types of apparatus or, at
least, data on apparatus and cipher methods in use by the enemy; and
a safe filing cabinet and card index for filing messages examined. A
typewriter is also desirable.

The office work on a cipher under examination should be done on paper
of a standard and uniform size. Printed forms containing twenty-six
ruled lines and a vertical alphabet are convenient and save time in
preparation of frequency tables. Any new cipher methods which are
found to be in use by the enemy should, when solved, be communicated
to all similar offices in the Army for their information.

Unless an enemy were exceedingly vigilant and changed keys and methods
frequently, such an office would, in a few days, be in a position
to disclose completely all intercepted cipher communications of the
enemy with practically no delay.








CHAPTER II

PRINCIPLES OF MECHANISM OF A WRITTEN LANGUAGE


With a few exceptions, notably Chinese, all modern languages are
constructed of words which in turn are formed from letters. In any
given language the number of letters, and their conventional order is
fixed. Thus English is written with 26 letters and their conventional
order is A, B, C, D, E, etc. Some letters are used very frequently and
others rarely. In fact, if ten thousand consecutive letters of a text
be counted and the frequency of occurrence of each letter be noted,
the numbers found will be practically identical with those obtained
from any other text of ten thousand letters in the same language. The
relative proportion of occurrence of the various letters will also
hold approximately for even very short texts.

Such a count of a large number of letters, when it is put in the form
of a table, is known as a frequency table. Every language has its own
distinctive frequency table and, for any given language, the frequency
table is almost as fixed as the alphabet. There are minor differences
in frequency tables prepared from texts on special subjects. For
example, if the text be newspaper matter, the frequency table will
differ slightly from one prepared from military orders and will also
differ slightly from one prepared from telegraph messages. But these
differences are very slight as compared with the differences between
the frequency tables of two different languages.

Again there is a fixed ratio of occurrence of every letter with every
other for any language and this, put in table form, constitutes a
table of frequency of digraphs. In the same way a table of trigraphs,
showing the ratio of occurrence of any three letters in sequence,
could be prepared, but such a table would be very extensive and a
count of the more common three letter combinations is usually used.

Other tables, such as frequency of initial and final letters of words,
might be of value but the common practice is to put cipher text into
groups of five or ten letters each and eliminate word forms. This is
almost a necessity in telegraphic and radio communication to enable
the receiving operator to check correct receipt of a message. He
must get five letters, neither more nor less, per word or he is
sure a mistake has been made. There is little difficulty, as a rule,
in restoring word forms in the deciphered message.

We will now take up, in order, the various frequency tables and
linguistic peculiarities of English and Spanish. Frequency tables
for French, German, and Italian for single letters will follow. All
frequency tables have been re-calculated from at least ten thousand
letters of text and compared with existing tables. No marked difference
has been found in any case between the re-calculated tables and those
already in use.




Data for Solution of Ciphers in English

Table I.--Normal frequency table. Frequency for ten thousand letters
and for two hundred letters. This latter is put in graphic form and is
necessarily an approximation. Taken from military orders and reports,
English text.


Table III.--Table of frequency of digraphs, duals or pairs
(English). This table was prepared from 20,000 letters, but the
figures shown are on the basis of 2,000 letters. For this reason
they are, to a certain extent, approximate; that is, merely because
no figures are shown for certain combinations, we should not assume
that such combinations never occur but rather that they are rare. The
letters in the horizontal line at the top and bottom are the leading
letters; those in the vertical columns at the sides are the following
letters. Thus in two thousand letters we may expect to find AH once
and HA twenty-six times.




Table IV.--Order of frequency of common pairs to be expected in a count
of 2,000 letters of military or semi-military English text. (Based
on a count of 20,000 letters).




Table V.--Table of recurrence of groups of three letters to be expected
in a count of 10,000 letters of English text.




Table VI.--Table of frequency of occurrence of letters as initials
and finals of English words. Based on a count of 4,000 words; this
table gives the figures for an average 100 words and is necessarily
an approximation, like Table III. English words are derived from so
many sources that it is not impossible for any letter to occur as an
initial or final of a word, although Q, X and Z are rare as initials
and B, I, J, Q, V, X and Z are rare as finals.




It is practically impossible to find five consecutive letters in an
English text without a vowel and we may expect from one to three with
two as the general average. In any twenty letters we may expect to
find from 6 to 9 vowels with 8 as an average. Among themselves the
relative frequency of occurrence of each of the vowels, (including
Y when a vowel) is as follows:




The foregoing tables give all the essential facts about the mechanism
of the English language from the standpoint of the solution of
ciphers. The use to be made of these tables will be evident when the
solution of different types of ciphers is taken up.




Data for the Solution of Ciphers in Spanish

The Spanish language is written with the following alphabet:



while the exact sense often depends upon the use of accents over the
vowels. However, in cipher work it is exceedingly inconvenient to use
the permanent digraphs, CH, LL and RR and they do not appear as such in
any specimens of Spanish or Mexican cipher examined. Accented vowels
and Ñ are also not found and we may, in general, say that a cipher
whose text is Spanish will be prepared with the following alphabet:




and the receiver must supply the accents and the tilde over the N to
conform to the general sense.

However, many Mexican cipher alphabets contain the letters K and
W. This is particularly true of the ciphers in use by secret service
agents who must be prepared to handle words like NEW YORK, WILSON
and WASHINGTON. The letters K and W will, however, have a negligible
frequency except in short messages where words like these occur more
than once.

In this connection, if a cipher contains Mexican geographical names
like CHIHUAHUA, MEXICO, MUZQUIZ, the letters H, X and Z will have a
somewhat exaggerated frequency.

In Spanish, the letter Q is always followed by U and the U is always
followed by one of the other vowels, A, E, I or O. As QUE or QUI
occurs not infrequently in Spanish text, particularly in telegraphic
correspondence, it is well worth noting that, if a Q occurs in a
transposition cipher, we must connect it with U and another vowel. The
clue to several transposition ciphers has been found from this simple
relation.


Table VII.--Normal frequency table for military orders and reports,
calculated on a basis of 10,000 letters of Spanish text. The graphic
form is on a basis of 200 letters.




In this table the vowels AEIOU = 45.65%; consonants LNRST = 30.33%;
consonants JKQXZ = 1.76%.



Table VIII.--Table of frequency of digraphs, duals or pairs, Spanish
text. Like Table III, this table is on the basis of 2,000 letters
although prepared from a count of 20,000 letters. For this reason
it is, to a certain extent an approximation; that is, merely because
no figures are shown for certain combinations, we should not assume
that such combinations never occur but rather that they are rare. The
letters in the horizontal lines at the top and bottom are the leading
letters; those in the vertical columns at the sides are the following
letters. Thus, in two thousand letters, we may expect to find AI
twice and IA twenty-three



Table IX.--Order of frequency of common pairs to be expected in a
count of 2,000 letters of Spanish military orders and reports. Based
on Table VIII.







CHAPTER III

TECHNIQUE OF CIPHER EXAMINATION


In time of active operations it is important that captured or
intercepted cipher messages reach the examining office with the least
possible delay. The text of messages, captured at a distance from
the examining office, should be sent to the office by telegraph or
telephone, the original messages being forwarded to the office as
soon thereafter as possible.

The preamble, "place from," date, address and signature, give most
important clues as to the language of the cipher, the cipher method
probably used, and even the subject matter of the message. If the whole
of a telegraphic or radio message is in cipher, it is highly probable
that the preamble, "place from," etc., are in an operators' cipher
and are distinct from the body of the message. As these operators'
ciphers are necessarily simple, an attempt should always be made to
discover, by methods of analysis to be set forth later, the exact
extent of the operator's cipher and then to decipher the parts of
the messages enciphered with it.

In military messages, we almost invariably find the language of the
text to be that of the nation to which the military force belongs. The
language of the text of the message of secret agents is, however,
another matter and, in dealing with such messages, we should use all
available evidence, both external and internal, before deciding finally
on the language used. Whenever a frequency table can be prepared,
such a table will give the best evidence for this purpose.

All work in enciphering and deciphering messages and in copying ciphers
should be done with capital letters. There is much less chance of
error when working with capitals and, with little practice, it is
just about as fast. An additional safeguard is to use black ink or
pencil for the plain text and colored ink or pencil for the cipher. A
separate color may be used for the key when necessary.

The following blank form is suggested as convenient for keeping a
record of a cipher under examination. It should accompany the cipher
through the examining process and should be filled in as the facts
are determined. This record, the original cipher and all notes of
work done during the examination, should be filed together when
the examination is completed, whether the cipher has been solved or
not. It may be that other ciphers solved later will give clues to
the solution of such unsolved ciphers.

The first column of this blank should be filled out from data furnished
by the officer obtaining the cipher from the enemy. A general
order, emphasizing the importance of promptly forwarding captured
or intercepted ciphers to an examining office, could specify that a
brief report embodying this data should be forwarded with each cipher.

The second column of the blank should be filled out progressively
as the work proceeds. The office number should be a serial one, the
first cipher examined being No. 1. The date and hour of receipt at
examining office will be a check as to the time required to transmit
it from place of capture. The spaces "From," "At," "To," "At," "Date,"
are for the information concerning sender and addressee of the cipher
and are to be obtained from the message. In case an operators' cipher
has been used, these parts of the message will have to be deciphered
before the blanks can be filled in.



The probable language of the text is assumed from the preceding
data and, if necessary, from internal evidence. Thus a cipher from
a Mexican source and not containing K or W is probably in Spanish.

The class and case are determined by the rules laid down later. The
space for remarks is to permit notation of any special features. When
the solution is completed, the date and hour are noted, the language
of text and key (if determined) are entered and a type number, to
identify it with other ciphers prepared by the same method (but not
necessarily the same key), is given to it. The file number is for
convenience in filing and in preparation of a card index.

The process of examination in an office with one examiner, one
stenographer and one clerk, might be as follows: On receipt of a
captured cipher with accompanying report, the stenographer makes four
copies of the cipher on the typewriter. The clerk and stenographer then
check the work. The stenographer then proceeds to fill out the first
column and first two lines of the second column of the record blank
from the report of the capturing officer, keeping the original cipher
and two copies with the record. He may also fill out the first seven
lines of the second column, if this data is on the captured cipher in
plain text. In the meantime the clerk is counting and setting down the
whole number of letters of the cipher and the occurrence of AEIOU,
LNRST, and JKQXZ, while the examining officer is looking over the
cipher for possible recurring groups of letters and underlining them
when found.

This work being completed, the examining officer is in a position,
ordinarily, to decide on the class of the cipher and he may have found
something in his examination which will lead him to the case under the
class. The clerk in this preliminary count should keep track of the
total occurrence of each of the fifteen check letters and not of the
three groups given above. This takes a little longer but when done,
the data for fifteen letters of the alphabet for a frequency table is
completed, leaving only eleven other letters, and in Spanish, but nine,
to be counted, in case it is necessary to prepare a frequency table.

If the examining officer decides the cipher to be of the transposition
class, no further work with frequency tables is necessary. The
clerk should proceed to count and set down the number of vowels in
each line and column and the examining officer should look for any
occurrence of the letter Q and try to connect it with U and another
vowel. The stenographer may be set to work putting the cipher into
rectangles of different dimensions. The clerk's work gives data for
possible rearrangement, for if the vowels are much out of proportion
at any point, they must be connected with the proper proportion of
consonants as a first step in rearrangement. Work with transposition
ciphers must necessarily include much of the fit and try method. The
details of this work are taken up later.

If a cipher seems to be a substitution cipher, the examining officer
should look over the frequency of occurrence of each of the fifteen
letters counted. If some letters (it is of no importance at present
which ones) occur much more frequently than others and some occur
rarely or not at all, we may safely decide on Case 4, 5 or 6 and let
the clerk proceed to finish the frequency table for the message. On the
other hand, if all the fifteen letters examined occur with somewhere
near the same frequency--for example, the most common letter occurring
not over three or four times as often as the least common letter--we
may at once eliminate the first three cases and let the clerk proceed
to examine the cipher for recurring pairs and groups, counting the
intervening letters, so that the examining officer may decide whether
Case 7, or some more complicated case, should be chosen.

If something more complicated than Case 7 has been used and other
ciphers are on hand awaiting examination, the cipher should go into
the unsolved file to be worked on when other work permits, unless
the contents of the cipher are believed to be very important. Every
opportunity should be taken to clean up the unsolved file and, whenever
a message is solved, the methods should be tried, if applicable,
to everything remaining in the file.

The first few days or weeks after the establishment of an examining
office will be the most trying time. When solved ciphers begin to
pile up, the methods of the enemy will be more and more apparent and
it will often be possible to determine the method from knowledge of
the name of the sender and receiver.

When a cipher has been solved, the solution should be prepared in
triplicate and given the serial number of the cipher. Any parts which
are not clear, through errors in enciphering or in transmission,
should be underlined or otherwise made conspicuous, so that the head
of the Intelligence Section may note them and, possibly, from other
sources, supply the deficiency.

One of the copies of the cipher and report of examination, with a
copy of the solution, should be turned over at once to the head of
the Intelligence Section or to the Chief of Staff. The other copies
of the solution should be filed with the original cipher, the report
of examination, and all work done on the cipher.

Periodically, say once a week or even daily at the beginning of
active operations, there should be an interchange between all
examining offices of solved messages involving new methods used by
the enemy. All the examining offices will thus be kept in touch. It
may also be possible to assign certain hostile radio stations to each
examining office to prevent duplication of work.








CHAPTER IV

CLASSES OF CIPHERS


There are, in general, two classes of ciphers. These are the
transposition cipher and the substitution cipher.

Substitution ciphers may be made up of substituted letters, numerals,
conventional signs or combinations of all three; and furthermore,
for a single letter of the original text there may be substituted a
single letter, numeral or sign or two or more of each, or a whole
word or group of figures, combination of conventional signs, or
combinations of all three of these elements. Thus substitution ciphers
may vary from those of extreme simplicity to those whose complication
defies any ordinary method of analysis and whose solution requires
the possession of long messages and much time and study. Fortunately
the more difficult substitution ciphers are rarely used for military
purposes, on account of the time and care required for enciphering
and deciphering.

Transposition ciphers are limited to the characters of the original
text. These characters are rearranged singly, according to some
predetermined method or key (monoliteral transposition), or whole
words are similarly rearranged (route cipher).

There may also be a combination of transposition and substitution
methods in enciphering a message but in this case it will fall into
the substitution class on first determination and after solution
as a substitution cipher it must be handled as a transposition
cipher. Examples of this case will be given.

We may also find transposition or substitution methods applied to
words taken from a code book, or to numbers which represent these
words. Thus cipher methods blend into code work, for a code is,
after all, only a specialized substitution cipher.

We can now lay down the rules for determining whether any given cipher
belongs to the substitution class or to the transposition class.

Count the number of letters in the message, the number of vowels,
AEIOU, the number of the consonants, LNRST, and the number of the
consonants, JKQXZ.

If the text is English and the cipher is a transposition cipher,
this proportion will hold; vowels AEIOU constitute 40% of the whole;
consonants LNRST, 30% and consonants JKQXZ, 3%.

If the text be Spanish the proportions for a transposition cipher
will be: vowels AEIOU 45%, consonants LNRST, 30%; consonants JKQXZ, 2%.

If these proportions do not hold within 5%, one way or the other,
the cipher is certainly a substitution cipher. Note, however,
that often the end of a message is filled with letters like K, X,
Z to complete cipher words and it is best to neglect the last word
or words in making a count. Also, if the cipher be a long one, this
determination can safely be made by taking 100 or 200 consecutive
letters of the message, either from the beginning or, if nulls at
the beginning are suspected, from the interior of the message.

The distinction between the route cipher (transposition) and the
substitution cipher where whole words are substituted for letters of
the original text, must be made on the basis of the words actually
used. It is better to consider such a message as a route cipher when
the words used appear to have some consecutive meaning bearing on the
situation at hand. A substitution cipher of this variety would only
be used for transmission of a short message of great importance and
secrecy, and then the chances are that certain words corresponding to
A, E, N, O and T would appear with such frequency as to point at once
to the fact that a substitution cipher was used. Watch the initial
or terminal letters in such a cipher; they may spell the message.

In general, the determination of class by proportion of vowels,
common consonants and rare consonants may be safely followed. We will
now proceed to the examination of the more common varieties of each
class of cipher.








CHAPTER V

EXAMINATION OF TRANSPOSITION CIPHERS


After having decided that a cipher belongs to the transposition class,
it remains to decide on the variety of cipher used. As, by definition,
a transposition cipher consists wholly of characters of the original
message, rearranged according to some law, we may, in general, say that
such a cipher offers fewer difficulties in solution than a substitution
cipher. A transposition cipher is like a picture puzzle; the parts are
all there and the solution merely involves their correct arrangement.



Case 1.--Geometrical ciphers. This case includes all ciphers in which
a certain number of the characters are chosen so that they will form
a square or rectangle of predetermined dimensions; and then these
characters are arranged according to a geometrical design.


of twenty-four letters and assuming a rectangle of six letters
horizontally, and four letters vertically, we may have:


It is simply a matter of inspection to read a message in a cipher
of this type, once the dimensions of the rectangles have been
determined. We place the whole or a portion of the message in such
rectangles and read horizontally, vertically and diagonally forward
and backward. Parts of words will at once be apparent and the whole
message is soon deciphered. Two examples will show the process.




Message


This message contains eight vowels or 38% out of twenty-one letters,
and the letters LNRST occur 7 times or 33%, the letters XQJKZ not
appearing. It is therefore a transposition cipher. Twenty-one letters
immediately suggest seven columns of three letters each or three
columns of seven letters each. Trying the former we have:



and reading down each column in succession (Case 1-b) reveals the
message to be "I am leaving this morning."




Message


There are 120 letters in this message with 57 vowels or 47% vowels,
and the letters LNRST occur 31 times or 26% of the whole.

Non-occurrence of K and W and vowel proportion leads us to the
assumption that it is a transposition cipher of a Spanish text. The
factors of 120 are 5 × 3 × 2 × 2 × 2. We may then have one rectangle
of 4 × 30 or one of 5 × 24 or two of 5 × 12, or three of 5 × 8, or
four of 5 × 6, or five of 3 × 8, or ten of 3 × 4, or twenty of 3 ×
2. The message being in a rectangle of 4 × 30, we can inspect it as it
stands and this is clearly not the arrangement if it be a geometrical
transposition cipher at all. It is best however to try the largest
possible rectangles first so we will put it in the form 5 × 24, thus:


Here an inspection shows this to be Case 1-f, alternate diagonal,
and the text to be "ME SITUO SOBRE PARRAL PORQUE ME PRESENCIA FUE
REVELADA POR U"; here the sense breaks but note that U is the twelfth
letter of the line and continue as if the rectangle were 5 × 12 and
we have "NA PAREJA QU." Now inspect the second rectangle of 5 × 12
in the same way and the sense continues "E SE ME ACERCO Y HUBO QUE
RECHAZAR POR EL FUEGO ALLI ESRERO ORDENES FINISX".

The practical way of examining a cipher of this type is to have several
men prepare rectangles of different dimensions, using the letters of
the cipher in the order received. The rectangles can be inspected very
rapidly when once prepared. Note that the dimensions of any rectangle
will rarely be such as to contain more than fifty letters, on account
of the necessity of filling up a rectangle with nulls if the number
of letters of the message is just a little greater than a multiple of
the rectangle. Also large rectangles give, for all but the diagonal
method, whole words in a line or column and these are easily noted.

The following ciphers come under Case 1:




Case 1-i.--The rail fence cipher, useful as an operators' cipher but
permits of no variation and is therefore read almost as easily as
straight text when the method is known. The message:





To solve this cipher, read down the columns in this order 8, 1, 15,
2, 14, 3, 13, 4, 12, etc. A variation is to arrange the cipher so
the columns are read upwards. Another is to arrange the ciphers so
the columns are read alternately upward and downward. The factors of
the number of letters in this case give the shape of the rectangle
as usual.

It will be seen that there are a great number of possible transposition
ciphers that come under Case 1 but practically all of them are
useless from a military standpoint because they do not depend on a
key which can be readily and frequently changed. However such ciphers
constantly crop up in cipher examination, being used for special
communication between parties who consider the regular military
ciphers too complicated. Thus some of these expedients have been used.




Reversed Writing.--(Special case of Case 1-a).

LEAVING TONIGHT is enciphered THGINOT GNIVAEL or it may be reversed
by words, thus GNIVAEL THGINOT or by groups of five letters, thus
IVAEL NOTGN XTHGI.




Vertical Writing.--(Special case of Case 1-b). Same message is
enciphered,




Case 2.--This case includes all transposition ciphers in which lines
and columns of the text are rearranged according to some key word or
key number. There are many varieties of this case but their solution
usually is arrived at through the methods suggested for Case 1, that
is, arrangement into appropriate rectangles and examination of lines
and columns for words or syllables. Rearrangement of columns or lines
follows until the solution is completed.




There are 108 letters in this message and examination shows it to be
a transposition cipher, English text. The number of letters, 108,
immediately suggests a rectangle of 12 × 9 or 9 × 12 letters. Put
into this form we have:



The vowel count of the lines shows the first arrangement to be the
more likely. We will now number the columns and try pairing off certain
ones which in no line would give impossible combinations of letters.


These combinations appear among others:



The word FIGHT stares at us from the first line; let us arrange the
columns thus:



We have the words FIGHTI(NG), VICIN(ITY), RENEWE(D), ANDVIL(LA),
RDINGT(O), RECE(IVED). With this to go on, we must choose column 11
as the next one and then in order, columns 8, 10, 7, 12, 9. But note
that the order 11, 8, 10, 7, 12, 9, is the same as the order 5, 2, 4,
1, 6, 3. The message was written in twelve columns and the columns
have been transposed in that order. We may, although it is entirely
unnecessary, speculate on the key word used. It was probably





meaning that the 4th column of the plain text was transferred in
enciphering so it became our 1st, the 2d column remained the 2d;
the 6th column became our 3d, etc.

Actually, this cipher was solved because the word VILLA was suspected
and all the necessary letters were found in line six of the arrangement
in twelve columns. The order 1, 6, 3, 11, 8 was tried and gave
this result.




The remainder of the solution followed the lines already laid down
and, naturally, offered no difficulties, in view of the large number
of connected syllables available.



This is a transposition cipher, English text, and contains 105
letters. The factors of 105 are 5 × 3 × 7 so that we must investigate
the following rectangles; 5 × 21, 15 × 7, three of 5 × 7, five of 3 ×
7 and seven of 5 × 3.


The vowel count of the columns of the rectangle 5 × 21 is very
satisfactory. Let us consider it as three blocks of 5 × 7 each,
since we must do this ultimately, and make a vowel count of columns
for these blocks.



This is also excellent, so we will try three blocks 5 × 7 and see
if rearrangement of horizontal lines will give results reading the
columns vertically.

The addition of line 6 above line 3 and line 4 below line 7 will
complete this cipher. The successive columns should be read downward.




Case 2-c. In this case, both lines and columns are rearranged by
means of a key word or key words. The method of solution is the same
as Case 2-a and 2-b except that the lines must be rearranged after
the columns have been correctly arranged, or in some cases, vice
versa. This cipher is not infrequently met with because it seems
to offer safety by use of two key words and by the great but only
apparent complexity of the method.




The first form looks the more likely from the vowel count. We proceed
to number the columns and lines and try rearrangement of columns so
as to obtain possible letter combinations from every line.



Among other combinations we have these:



A very casual inspection of the lines shows that they should be
rearranged in order 6, 1, 2, 7, 3, 5, 4, as follows:

Although of no particular importance, it may be stated that the
column key in this case was GRAND and the line key was CENTRAL,
both used as in enciphering Case 2-a.




Case 3. Route ciphers. In this case, whole words of the message
are transposed according to some of the methods of Case 1 or 2 or
their equivalents. The route cipher is little used at present. Its
development and use during the Civil War was caused by the inability
of the telegraphers of that day to handle regular cipher matter
correctly and rapidly. It was, even in those days, frankly only
a delaying cipher and, to be of any value, had to be filled with
meaningless words to conceal the message proper. An example from
the Signal Book will suffice to show the general character of route
ciphers. To one familiar with monoliteral transposition ciphers,
even the best of route ciphers offers but little difficulty.

"To encipher the message 'MOVE DAYLIGHT. ENEMY APPROACHING FROM
NORTH. PRISONERS SAY STRENGTH ONE HUNDRED THOUSAND. MEET HIM AS
PLANNED.' arrange as follows:



Here the route is down the first column, up the fourth, down the
second and up the third."

This cipher was often complicated by the introduction of nulls for
every fifth word. Thus the above message might be sent:


The words in italics are nulls and not a part of the message and the
receiver eliminates them before arranging his message in columns to
get the sense of it.

As an additional complication, it was customary for each correspondent
to have a dictionary or code in which the names of all prominent
generals and places and many of the prominent verbs,--as to march,
to sail, to encamp, to attack, to retreat,--were represented by
other words.

A route cipher using the code words of the War Department code might
have some advantages over the method of enciphering code messages as
prescribed in that Code.




General Remarks on Transposition Ciphers

It is the consensus of opinion of experts that the transposition
cipher is not the best one for military purposes. It does not
fulfill the first, second, and third of Kerckhoffs' requirements as
to indecipherability, safety when apparatus and method fall into the
hands of the enemy, and dependability on a readily changeable key word.

However, transposition ciphers are often encountered. They are
favorites with those who find the substitution ciphers too difficult
and too tedious to handle and who believe that their transposition
methods are either absolutely indecipherable or sufficiently so
for the purpose of concealing the text of a message for the time
being. They seem to be particularly popular with secret agents and
spies, presumably because special apparatus is rarely necessary in
enciphering and deciphering.

Although the number of transposition methods is legion, they can
practically all be considered under one of the three cases already
discussed. It is surprising how often transposition ciphers prepared
by complicated rules, will, on analysis, be seen to be very simple.

To be successful in solving transposition ciphers, one should
constantly practice reading backward and up and down columns, so that
the common combinations of letters are as quickly identified when seen
thus as when encountered in straight text. Combinations like EHT,
LLIW, ROF, DNA, etc., should be appreciated immediately as common
words written backward.

A study of the table of frequency of digraphs or pairs is also
excellent practice and such a table should be at hand when a
transposition cipher is under consideration. It assists greatly if
Case 2 be encountered and is of considerable use in solving Case 1.

The solution of route ciphers is necessarily one of try and fit,
with the knowledge that such ciphers usually are read up and down
columns. It is not believed that route ciphers will often be met with
at the present day.








CHAPTER VI

EXAMINATION OF SUBSTITUTION CIPHERS


When an unknown cipher has been put into the substitution class by
the methods already described we may proceed to decide on the variety
of substitution cipher which has been used.

There are a few purely mechanical ways of solving some of the simple
cases of substitution ciphers but as a general rule some or all of
the following determinations must be made:

1. By preparation of a frequency table for the message we determine
whether one or more substitution alphabets have been used and, if
one only has been used, this table leads to the solution.

2. By certain rules we determine how many alphabets have been used,
if there are more than one, and then isolate and analyze each alphabet
by means of a frequency table.

3. If the two preceding steps give no results we have to deal with a
cipher with a running key, a cipher of the Playfair type, or a cipher
where two or more characters are substituted for each letter of the
text. Some special cases under this third head will be given but,
in general, military ciphers of the substitution class will usually
be found to come under the first two heads, on account of the time
and care required in the preparation and deciphering of messages by
the last named methods and the necessity, in many cases, of using
complicated machines for these processes.




Case 4-a.

Message


           OBQFO BPBRP QBAML OBHIF PILFQ FJBOX OFLNR BIXOZ EL


From the recurrence of B, F and O, we may conclude that a single
substitution alphabet was used for this message. If so and if the
alphabet runs in the same order and direction as the regular alphabet,
the simplest way to discover the meaning of the message is to take
the first two words and write alphabets under each letter as follows,
until some line makes sense:


The word RETIRESE occurs in the fourth line, and, if the whole message
be handled in this way we find the rest of the fourth line to read
USTED POR EL MISMO ITINERARIO QUE MARCHO. The message was enciphered
using an alphabet where A = X, B = Y, C = Z, D = A, etc. noting that
as this message is in Spanish the letters K and W do not appear in
the alphabet.




Here each word of the message comes out on a different line, and
noting in each case the letter corresponding to A, we have the word
QUEMADOS which is the key. The cipher alphabet changed with each word
of the message.

A variation of this case is where the cipher alphabet changes according
to a key word but the change comes every five letters or every ten
letters of the message instead of every word. The text of the message
can be picked up in this case with a little study.

Note in using case 4 that if we are deciphering a Spanish message
we use the alphabet without K or W as a rule, altho if the letters
K or W appear in the cipher it is evidence that the regular English
alphabet is used.




Case 5-a.

Message


This message contains K and W and therefore we expect the English
alphabet to be used. The frequency of occurrence of A, L, N, R and
W has lead us to examine it under case 4 but without result. Let us
set down the first two words and decipher them with a cipher disk
set A to A and then proceed as in case 4.


The message is thus found to be enciphered with a cipher disk set
A to E and the text is: BRITISH GOVERNMENT PLACED CONTRACTS WITH
FOLLOWING FIRMS DURING SEPTEMBER.




Case 5-b.

Same as case 4-b except that the cipher message must be deciphered
by means of a cipher disk set A to A before proceeding to make up
the columns of alphabets. The words of the deciphered message will
be found on separate lines, the lines being indicated as a rule by
a key word which can be determined as in case 4-b.

The question of alphabetic frequency has already been discussed in
considering the mechanism of language. It is a convenient thing to put
the frequency tables in a graphic form and to use a similar graphic
form in comparing unknown alphabets with the standard frequency
tables. For instance the standard Spanish frequency table put in
graphic form is here presented in order to compare with it the
frequency table for the message discussed in case 4-a.



Our first assumption might be that B = A and F = E but it is evident
at once that in that case, S, T, U and V (equal to R, S, T and U)
do not occur and a message even this short without R, S, T or U is
practically impossible. By trying B = E we find that the two tables
agree in a general way very well and this is all that can be expected
with such a short message. The longer the message the nearer would
its frequency table agree with the standard table. Note that if a
cipher disk has been used, the alphabet runs the other way and we
must count upward in working with a graphic table. Note also that if,
in a fairly long message, it is impossible to coördinate the graphic
table, reading either up or down, with the standard table and yet some
letters occur much more frequently than others and some do not occur
at all, we have a mixed alphabet to deal with. The example chosen for
case 6-a is of this character. An examination of the frequency table
given under that case shows that it bears no graphic resemblance to the
standard table. However, as will be seen in case 7-b, the preparation
of graphic tables enables us to state definitely that the same order
of letters is followed in each of a number of mixed alphabets.




General Remarks

Any substitution cipher, enciphered by a single alphabet composed of
letters, figures or conventional signs, can be handled by the methods
of case 6. For example, the messages under case 4-a and 5-a are easily
solved by these methods. But note that the messages under case 4-b
and 5-b cannot so be solved because several alphabets are used. We
will see later that there are methods of segregating the different
alphabets in some cases where several are used and then each of the
alphabets is to be handled as below.




This message was received from a source which makes us sure it is in
Spanish. The occurrence of B, H, P and S has tempted us to try the
first two words as in case 4 and 5 but without result. We now prepare
a frequency table, noting at the same time the preceding and following
letter. This latter proceeding takes little longer than the preparation
of an ordinary frequency table and gives most valuable information.


It is clear from an examination of this table that we have to deal
with a single alphabet but one in which the letters do not occur in
their regular order.

We may assume that P and S are probably A and E, both on account of
the frequency with which they occur and the variety of their prefixes
and suffixes. If this is so, then B and H, are probably consonants
and may represent R and N respectively. D and X are then vowels by
the same method of analysis. Noting that HC occurs three times and
taking H as N we conclude that C is probably T. Substitute these
values in the last three words of the message because the letters
assumed occur rather frequently there.



Now Z is always prefixed by S and may be L. Taking X=I and D=O,
(they are certainly vowels), V=G and Y=M, we have


Substituting these values in the rest of the message we have



We may now take Q=F, O=D, E=S, R=B, T=C, A=P and J=U and the message
is complete. We are assisted in our last assumption by noting that
S=E and E=S, etc., and we may on that basis reconstruct the entire
alphabet. The letters in parenthesis do not occur in the message but
may be safely assumed to be correct.



It is always well to attempt the reconstruction of the entire
alphabet for use in case any more cipher messages written in it are
received.----




The address and signature indicate that this message is in English.

There are 250 letters in the cipher; the vowels AEIOU occur 109 times
or 43.6%, the letters LNRST occur 62 times or 24.8%, and the letters
KQVXZ occur 5 times or 2%. The proportion in the case of the vowels
is somewhat too large and, in the case of the letters LRNST, it is
too small. It is then questionable whether this is a transposition
cipher altho, at first glance it might appear to be one.

On examination for parts of possible words we are at once struck by
the occurrence at irregular intervals of recurring groups, viz:




This is a strong indication that the cipher is a substitution cipher,
so, to make an examination a frequency table will be constructed.



Superficially, this looks like a normal frequency table, but O is
the dominant letter, followed by H, E, A, T, I, N, S, in the order
named. It is certainly Case 6 if it is a substitution cipher at all.

Let us see what can be done by assuming O=E; the triplet ENO, occurring
six times might well be THE and E=T and N=H. A glance at the frequency
table shows this to be reasonable. Now substitute these letters in some
likely groups. FNOHOENO becomes _HE_ETHE; FTEN becomes _TH; ENOENHO
becomes THETH_E; ENOHO becomes THE_E. A bit of study will show that
F=W, T=I and H=R and the frequency table bears this out except that
H(=R) seems to occur too frequently. The recurring groups containing
DAC (see above) occur in such a way that we may be sure DAC is one
word, FTRR is another and FTEN(=WITH) is a third. Now FTRR becomes
WI__, which can only be completed by a double letter. LL fills the
bill and we may say R=L. As DAC starts the message and is followed
by FTRR (=WILL) it is reasonable to try DAC=YOU. Looking up DAC in
the frequency table it is evident that we strain nothing by this
assumption. We now have:


Now take the group ENOUTHOMEAH which occurs twice. This
becomes THE_IRE_TOR and if we substitute U=D and M=C we have THE
DIRECTOR. Next the group (FTRR)BHAMOOUEA becomes (WILL) _ROCEEDTO
and the context gives word with missing letter as PROCEED, from
which B=P. Next the group (ENO) IZTIETASMOSEOHIEYOCK(FNOHO) becomes
(THE)__I_TIO_CE_TER_T_EU_(WHERE) and the group (FTEN)EFAPHOSMNIZTIEAHL
becomes (WITH)TWO_RE_CH__I_TOR_. The substitution of A for I, V for
Z, N for S and F for P makes the latter group read (WITH TWO FRENCH
AVIATORS and the former read (THE)AVIATION CENTER AT _EU_(WHERE).

Now the word YOCK = (_EU_) is the name of a place, evidently. We
find another group containing Y, viz: ENOSTSMAYBISD which becomes
THENINCO_PANY so that evidently we should substitute M for Y. The
other occurrence of Y (=M) is in the group EAYOEQISU which becomes
TOMET_AND. A reasonable knowledge of geography gives us the words
MEUX and METZ so that X should be substituted for K and Z for Q.

We now have sufficient letters for a complete deciphering of the
message.


The message deciphers:


The substitution of B for G, G for W and K for V completes the
cipher. This cipher is difficult only because the cipher alphabet is
made up, not haphazard, but scientifically with proper consideration
for the natural frequency of occurrence of the letters. In cipher work
it is dangerous to neglect proper analysis and jump at conclusions.

In the study of Mexican substitution ciphers, several alphabets have
been found which are made up in a general way, like the one discussed
in this case.